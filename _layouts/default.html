<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ page.title }}</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/css/main.css" />
  </head>
  <body data-theme="dark">
    <button id="theme-toggle" title="Switch theme">
        <i class="fas fa-moon"></i>
    </button>
    <nav>
      <ul>
        <li><a href="/" {% if page.url == "/" %}class="active"{% endif %}>Home</a></li>
        <li><a href="/about" {% if page.url contains "/about" %}class="active"{% endif %}>About</a></li>
        <li><a href="/cv" {% if page.url contains "/cv" %}class="active"{% endif %}>CV</a></li>
        <li><a href="/blog" {% if page.url contains "/blog" %}class="active"{% endif %}>Blog</a></li>
      </ul>
    </nav>

    <div class="container">
      <main class="main-content fade-in">
        {{ content }}
      </main>
    </div>

    <footer>
      <ul>
        <li><a href="mailto:jingxian06@hotmail.com" class="footer-link"><i class="fas fa-envelope"></i> email</a></li>
        <li><a href="https://github.com/J-Xian" class="footer-link"><i class="fab fa-github"></i> github.com/J-Xian</a></li>
        <li><a href="https://www.linkedin.com/in/j-xian" class="footer-link"><i class="fab fa-linkedin"></i> linkedin.com/in/J-Xian</a></li>
      </ul>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const themeToggle = document.getElementById('theme-toggle');
            const body = document.body;
            const icon = themeToggle.querySelector('i');
            const mainContent = document.querySelector('.main-content');

            // Apply fade-in animation
            setTimeout(() => {
                mainContent.classList.add('visible');
            }, 500);

            // Theme toggle logic
            themeToggle.addEventListener('click', () => {
                if (body.getAttribute('data-theme') === 'light') {
                    body.removeAttribute('data-theme');
                    icon.classList.remove('fa-sun');
                    icon.classList.add('fa-moon');
                } else {
                    body.setAttribute('data-theme', 'light');
                    icon.classList.remove('fa-moon');
                    icon.classList.add('fa-sun');
                }
            });

            // Intersection Observer for scroll-based effects
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };
            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, observerOptions);

            // Observe all elements with the 'fade-in' class
            document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
        });
    </script>
  </body>
</html>
